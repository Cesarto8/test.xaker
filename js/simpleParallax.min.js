!function(e){"object"==typeof module&&"object"==typeof module.exports?e(require("jquery"),window,document):e(jQuery,window,document)}(function(i,r,a,o){"use strict";var l=function(){for(var e,t="transform webkitTransform mozTransform oTransform msTransform".split(" "),n=(a.createElement("div"),0);e===o;)e=a.createElement("div").style[t[n]]!=o?t[n]:o,n++;return e}();!function(){for(var o=0,e=["ms","moz","webkit","o"],t=0;t<e.length&&!r.requestAnimationFrame;++t)r.requestAnimationFrame=r[e[t]+"RequestAnimationFrame"],r.cancelAnimationFrame=r[e[t]+"CancelAnimationFrame"]||r[e[t]+"CancelRequestAnimationFrame"];r.requestAnimationFrame||(r.requestAnimationFrame=function(e,t){var n=(new Date).getTime(),i=Math.max(0,16-(n-o)),a=r.setTimeout(function(){e(n+i)},i);return o=n+i,a}),r.cancelAnimationFrame||(r.cancelAnimationFrame=function(e){clearTimeout(e)})}();var s="simpleParallax",e=-1,m=!1;function c(e,t){this.element=e,this.$element=i(this.element),this._name=s,this._defaults=i.fn.simpleParallax.defaults,this.options=i.extend({},this._defaults,t),this.init()}i.extend(c,{getViewportOffset:function(){var e=i(r);this.viewportHeight=e.outerHeight(),this.viewportTop=e.scrollTop()-20,this.viewportBottom=e.scrollTop()+c.viewportHeight+20}}),i.extend(c.prototype,{occurence:[],init:function(){var e=this;e.wrapElement(),this.occurence.push(e),e.proceedElement(e),m&&e.proceedLoop()},wrapElement:function(){var e=this;e.$element.closest("picture").length?e.$elementToWrap=e.$element.parent("picture"):e.$elementToWrap=e.$element,e.$elementToWrap.wrap('<div class="simpleParallax" style="overflow:hidden"></div>'),e.$elementContainer=e.$element.closest(".simpleParallax"),e.$element[0].style[l]="scale("+e.options.scale+")"},unWrapElement:function(e){e.unwrap("simpleParallax")},getElementOffset:function(){var e=this,t=e.$elementContainer[0];e.elementHeight=t.offsetHeight,e.elementTopX=t.offsetTop,e.elementBottomX=e.elementTopX+e.elementHeight},isVisible:function(){return this.elementBottomX>c.viewportTop&&this.elementTopX<c.viewportBottom},calculateRange:function(){var e=this;e.elementImageHeight=e.$element[0].getBoundingClientRect().height,e.rangeMax=Math.abs(e.elementHeight-e.elementImageHeight),"down"!==e.options.orientation&&"right"!==e.options.orientation||(e.rangeMax*=-1)},calculate:function(){var e=this,t=e.$element.data(s+"_percentage"),n=(c.viewportBottom-20-e.elementTopX)/((c.viewportHeight+e.elementHeight)/100);return 100<n?n=100:n<0&&(n=0),t!==n&&(e.calculateRange(),e.translateValue=n/100*e.rangeMax-e.rangeMax/2,e.$element.data(s+"_percentage",n),!0)},animate:function(){var e,t,n=this;"up"==n.options.orientation||"down"==n.options.orientation?t="translateY":"left"!=n.options.orientation&&"right"!=n.options.orientation||(t="translateX"),e="scale("+n.options.scale+") "+t+"("+n.translateValue+"px)",n.$element[0].style[l]=e},proceedElement:function(e){(e.getElementOffset(),e.isVisible())&&(e.calculate()&&e.animate())},proceedLoop:function(){var t=this;e!==r.pageYOffset&&(e=r.pageYOffset,i.each(this.occurence,function(e){0===e&&c.getViewportOffset(),t.proceedElement(this.occurence[e])})),r.requestAnimationFrame(t.proceedLoop.bind(t))},destroy:function(){var e=this;i(".simpleParallax").each(function(){i(this).find("img")[0].style[l]="",i(this).removeData(),e.unWrapElement(i(this))}),e.unbindEvents()}}),i.fn.simpleParallax=function(t){var n=this.length;return this.each(function(e){i.data(this,s)||(n-1==e&&(m=!0),i.data(this,s,new c(this,t)))}),this},i.fn.simpleParallax.defaults={orientation:"up",scale:"1.2"}});
